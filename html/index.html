<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ãƒ¡ãƒ‹ãƒ¥ãƒ¼æŠ•ç¥¨</title>
    <style>
      body {
        font-family: "Helvetica Neue", Arial, sans-serif;
        background-color: #f4f4f4;
        text-align: center;
        padding: 20px;
        color: #333;
      }

      /* ãƒªãƒ³ã‚¯ã®ã‚¹ã‚¿ã‚¤ãƒ« */
      .nav-link {
        margin-bottom: 30px;
        display: inline-block;
        font-size: 1.1em;
        text-decoration: none;
        color: #007bff;
        border: 1px solid #007bff;
        padding: 10px 20px;
        border-radius: 30px;
        background: white;
        transition: all 0.3s;
      }
      .nav-link:hover {
        background: #007bff;
        color: white;
      }

      /* ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®èª¿æ•´ */
      #menu-container {
        display: grid;
        /* å¹…ã«åˆã‚ã›ã¦è‡ªå‹•è©°ã‚è¾¼ã¿ã€‚æœ€å°å¹…ã‚’å°‘ã—åºƒã’ã¦æ”¹è¡Œã—ã«ããã™ã‚‹ */
        grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
        gap: 20px;
        max-width: 1200px;
        margin: 0 auto;
      }

      /* ã‚«ãƒ¼ãƒ‰ã®ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆé«˜ã•æƒãˆã®è‚ï¼‰ */
      .menu-card {
        background: white;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        transition: transform 0.2s, box-shadow 0.2s;
        cursor: pointer;
        border: 2px solid transparent;

        /* Flexboxã§ä¸­èº«ã‚’ç¸¦ã«ä¸¦ã¹ã‚‹ */
        display: flex;
        flex-direction: column;
        justify-content: space-between; /* ä¸Šä¸‹ã«åˆ†æ•£ */
        height: 100%; /* ã‚°ãƒªãƒƒãƒ‰ã‚»ãƒ«ã®é«˜ã•ã„ã£ã±ã„ã«åºƒã’ã‚‹ */
        box-sizing: border-box;
      }

      .menu-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        border-color: #007bff;
      }

      .menu-card:active {
        transform: scale(0.98);
        background-color: #f0f8ff;
      }

      /* ãƒ¡ãƒ‹ãƒ¥ãƒ¼å */
      .menu-name {
        font-weight: bold;
        font-size: 1.1em;
        margin-bottom: 15px;
        color: #444;
        /* åå‰ãŒçŸ­ãã¦ã‚‚é•·ãã¦ã‚‚ã€ãƒœã‚¿ãƒ³ã®ä½ç½®ã‚’åˆã‚ã›ã‚‹ãŸã‚ã«ä½™ç™½èª¿æ•´ */
        flex-grow: 1;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      /* ãƒœã‚¿ãƒ³ */
      .vote-btn {
        background-color: #007bff;
        color: white;
        border: none;
        padding: 10px 0;
        border-radius: 6px;
        width: 100%;
        font-weight: bold;
        font-size: 0.95em;
      }

      /* -----------------------
           ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ï¼ˆè‡ªå‹•ã§æ¶ˆãˆã‚‹ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ï¼‰
           ----------------------- */
      #toast {
        visibility: hidden;
        min-width: 300px;
        background-color: #333;
        color: #fff;
        text-align: center;
        border-radius: 50px;
        padding: 16px;
        position: fixed;
        z-index: 100;
        left: 50%;
        bottom: 30px;
        transform: translateX(-50%); /* å·¦å³ä¸­å¤®å¯„ã› */
        font-size: 16px;
        opacity: 0;
        transition: opacity 0.3s, bottom 0.3s;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      }

      #toast.show {
        visibility: visible;
        opacity: 1;
        bottom: 50px; /* ãµã‚ã£ã¨æµ®ãä¸ŠãŒã‚‹æ¼”å‡º */
      }
    </style>
  </head>
  <body>
    <a href="/result.html" class="nav-link">ğŸ“Š æŠ•ç¥¨çµæœ(ã‚°ãƒ©ãƒ•)ã‚’è¦‹ã‚‹</a>

    <h1 style="margin-bottom: 10px">ä»Šæ—¥ã®ãƒ©ãƒ³ãƒã€ä½•ã«ã™ã‚‹ï¼Ÿ</h1>
    <p style="color: #666; margin-bottom: 30px">
      é£Ÿã¹ãŸã„ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦æŠ•ç¥¨ã—ã¦ãã ã•ã„
    </p>

    <div id="menu-container"></div>

    <!-- ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ç”¨ã®ç®±ï¼ˆæœ€åˆã¯è¦‹ãˆãªã„ï¼‰ -->
    <div id="toast">æŠ•ç¥¨ã—ã¾ã—ãŸï¼</div>

    <script>
      async function loadMenu() {
        const response = await fetch("/api/votes");
        const data = await response.json();
        const container = document.getElementById("menu-container");
        container.innerHTML = "";

        data.forEach((item) => {
          const card = document.createElement("div");
          card.className = "menu-card";
          // ã‚«ãƒ¼ãƒ‰å…¨ä½“ã‚¯ãƒªãƒƒã‚¯ã§æŠ•ç¥¨
          card.onclick = () => vote(item.id, item.name);

          card.innerHTML = `
                    <div class="menu-name">${item.name}</div>
                    <button class="vote-btn">æŠ•ç¥¨ã™ã‚‹</button>
                `;
          container.appendChild(card);
        });
      }

      let toastTimeout;
      async function vote(menuId, menuName) {
        // ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡
        await fetch(`/api/vote/${menuId}`, { method: "POST" });

        // ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’è¡¨ç¤º
        showToast(`ã€Œ${menuName}ã€ã«æŠ•ç¥¨ã—ã¾ã—ãŸï¼ğŸ‰`);
      }

      function showToast(message) {
        const toast = document.getElementById("toast");
        toast.innerText = message;
        toast.className = "show";

        // é€£ç¶šã§æŠ¼ã•ã‚ŒãŸã¨ãã®ãŸã‚ã«ã‚¿ã‚¤ãƒãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆ
        if (toastTimeout) clearTimeout(toastTimeout);

        // 2.5ç§’å¾Œã«æ¶ˆã™
        toastTimeout = setTimeout(() => {
          toast.className = toast.className.replace("show", "");
        }, 2500);
      }

      loadMenu();
    </script>
  </body>
</html>
